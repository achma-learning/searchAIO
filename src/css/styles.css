.focus-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.4);
      /* Darkens the screen */
      backdrop-filter: blur(5px);
      /* macOS blur effect */
      -webkit-backdrop-filter: blur(5px);
      z-index: 10;
      /* Above content, below search */
      opacity: 0;
      pointer-events: none;
      /* Click-through when hidden */
      transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .focus-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }

    .dark-mode .focus-overlay {
      background: rgba(0, 0, 0, 0.6);
      /* Darker in dark mode */
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #000022 0%, #051937 50%, #001f3f 100%);
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }

    .search-container {
      margin-top: 40px;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
      padding: 30px;
      max-width: 1200px;
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 24px;

      /* NEW: Float above overlay */
      position: relative;
      z-index: 20;
      /* Higher than overlay (10) */
      transition: box-shadow 0.3s ease;
    }

    /* Extra glow when focused */
    .search-container.focused {
      box-shadow: 0 12px 48px rgba(156, 90, 242, 0.2);
    }

    .dark-mode .search-container {
      background: #1a2332;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(100, 181, 246, 0.1);
    }

    .dark-mode .search-container.focused {
      box-shadow: 0 12px 48px rgba(156, 90, 242, 0.3);
    }

    .category-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 20px;
    }

    .category-section {
      background: linear-gradient(145deg, #f8f9fa, #e9ecef);
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .category-section:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
    }

    .category-title {
      font-weight: 900;
      /* Extra bold */
      color: #2c3e50;
      margin-bottom: 12px;
      font-size: 1.1em;
      border-bottom: 2px solid #667eea;
      padding-bottom: 8px;
      font-family: 'Papyrus', cursive, fantasy;
    }

    .radio-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .radio-group label {
      cursor: pointer;
      padding: 6px 10px;
      border-radius: 6px;
      transition: all 0.2s ease;
      font-size: 0.95em;
      display: flex;
      align-items: center;
      font-family: 'Papyrus', cursive, fantasy;
    }

    .radio-group input[type=radio] {
      accent-color: #9c5af2;
      cursor: pointer;
      margin-right: 8px;
      width: 16px;
      height: 16px;
      min-width: 16px;
      /* Prevents shrinking */
      min-height: 16px;
      /* Prevents shrinking */
      flex-shrink: 0;
      /* Prevents flex compression */
      vertical-align: middle;
      /* Aligns with text */
    }

    .dark-mode .radio-group input[type=radio] {
      accent-color: #9c5af2;
    }

    .radio-group label.selected,
    .radio-group label:hover {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      font-weight: 600;
      transform: translateX(4px);
    }

    .search-bar {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
      position: relative;
    }

    #searchForm {
      display: flex;
      align-items: center;
      gap: 10px;
      width: 100%;
      justify-content: center;
      flex-wrap: wrap;
    }

    #searchInput {
      padding: 12px 16px;
      font-size: 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      min-width: 300px;
      width: 100%;
      background: #fafafa;
      transition: all 0.3s ease;
      font-family: 'Roboto', sans-serif;
      font-weight: 500;
    }

    #searchInput:focus {
      border-color: #9c5af2 !important;
      /* Purple border */
      outline: none;
      background: white;

      /* macOS-style glow ring */
      box-shadow: 0 0 0 4px rgba(156, 90, 242, 0.4);
    }

    .dark-mode #searchInput:focus {
      border-color: #9c5af2 !important;
      background: rgba(255, 255, 255, 0.12);
      box-shadow: 0 0 0 4px rgba(156, 90, 242, 0.3);
    }

    button {
      padding: 12px 24px;
      font-size: 15px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease;
      font-weight: 600;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    button:active {
      transform: translateY(0);
    }

    #searchForm button[type="submit"] {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    #wikiToggleBtn {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
    }

    #filetypesBtn {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      color: white;
    }

    #duckBangBtn {
      background: linear-gradient(135deg, #DE5833 0%, #F7931E 100%);
      color: white;
    }

    .checkbox-label {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      cursor: pointer;
      user-select: none;
    }

    #searchSource {
      font-size: 14px;
      color: #555;
      text-align: center;
      font-weight: 600;
      min-height: 20px;
      padding: 8px;
      border-radius: 6px;
      background: #f8f9fa;
      font-family: 'JetBrains Mono', 'Courier New', monospace;
    }

    #wikiContent {
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
      font-size: 14px;
      color: #333;
      max-height: 400px;
      overflow-y: auto;
      display: none;
    }

    #wikiContent h4 {
      margin-top: 16px;
      margin-bottom: 8px;
      color: #667eea;
      font-size: 1.1em;
    }

    #wikiContent ul {
      margin: 0 0 16px 0;
      padding: 0;
      list-style: none;
    }

    #wikiContent li {
      margin-bottom: 8px;
      padding: 6px 10px;
      border-radius: 4px;
      transition: background 0.2s ease;
    }

    #wikiContent li:hover {
      background: #f0f0f0;
    }

    #wikiContent b {
      color: #667eea;
      font-weight: 700;
      font-family: 'Courier New', monospace;
      background: #f0f0ff;
      padding: 2px 6px;
      border-radius: 3px;
    }

    .checkbox-container {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid #e0e0e0;
    }

    #filetypesPopup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 600px;
      max-height: 80vh;
      overflow-y: auto;
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      padding: 24px;
      font-size: 14px;
      color: #333;
      display: none;
      z-index: 2000;
    }

    #filetypesPopup.show {
      display: block;
    }

    .popup-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      z-index: 1999;
    }

    .popup-overlay.show {
      display: block;
    }

    #filetypesPopup h3 {
      margin: 0 0 16px 0;
      font-size: 1.4em;
      color: #2c3e50;
      border-bottom: 3px solid #667eea;
      padding-bottom: 10px;
    }

    #filetypesPopup .close-btn {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 28px;
      cursor: pointer;
      color: #999;
      background: none;
      border: none;
      padding: 0;
      width: auto;
      height: auto;
    }

    #filetypesPopup .close-btn:hover {
      color: #333;
      transform: none;
      box-shadow: none;
    }

    #filetypesPopup ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    #filetypesPopup li.category {
      font-weight: 700;
      margin-top: 16px;
      margin-bottom: 8px;
      color: #667eea;
      font-size: 1.1em;
    }

    #filetypesPopup li.item {
      cursor: pointer;
      padding: 10px 12px;
      border-radius: 6px;
      border-bottom: 1px solid #f0f0f0;
      transition: all 0.2s ease;
    }

    #filetypesPopup li.item:hover {
      background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
      transform: translateX(4px);
      border-left: 3px solid #667eea;
    }

    #filetype-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 1rem;
    }

    .filetype-category h4 {
      font-weight: 700;
      color: #667eea;
      margin-bottom: 10px;
      font-size: 1.1em;
      border-bottom: 1px solid #ddd;
      padding-bottom: 5px;
    }

    .dark-mode .filetype-category h4 {
      color: #64b5f6;
      border-bottom-color: #455a64;
    }

    .filetype-item label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      padding: 5px;
      border-radius: 4px;
    }

    .filetype-item label:hover {
      background-color: #f0f2f5;
    }

    .dark-mode .filetype-item label:hover {
      background-color: #2c3e50;
    }

    .popup-buttons {
      display: flex;
      justify-content: flex-end;
      gap: 12px;
      margin-top: 24px;
      padding-top: 16px;
      border-top: 1px solid #e0e0e0;
    }

    .dark-mode .popup-buttons {
      border-top-color: #455a64;
    }

    #applyFiletypes {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    #clearFiletypes {
      background-color: #f1f3f4;
      border: 1px solid #dadce0;
    }

    .dark-mode #clearFiletypes {
      background-color: #303134;
      color: #e8eaed;
      border-color: #5f6368;
    }

    .favicon-icon {
      width: 16px;
      height: 16px;
      margin-right: 8px;
      vertical-align: middle;
      border-radius: 2px;
      /* Slightly rounded corners for favicons */
    }

    /* Responsive */
    @media (max-width: 768px) {
      .search-container {
        padding: 20px;
        margin-top: 20px;
      }

      .category-row {
        grid-template-columns: 1fr;
      }

      #searchInput {
        min-width: 100%;
      }

      #searchForm {
        flex-direction: column;
        width: 100%;
      }

      #searchForm button {
        width: 100%;
      }

      #filetypesPopup {
        width: 95%;
        max-height: 70vh;
      }
    }

    /* Scrollbar styling */
    #wikiContent::-webkit-scrollbar,
    #filetypesPopup::-webkit-scrollbar {
      width: 8px;
    }

    #wikiContent::-webkit-scrollbar-track,
    #filetypesPopup::-webkit-scrollbar-track {
      background: #f0f0f0;
      border-radius: 4px;
    }

    #wikiContent::-webkit-scrollbar-thumb,
    #filetypesPopup::-webkit-scrollbar-thumb {
      background: #667eea;
      border-radius: 4px;
    }

    #stars-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
    }

    #stars,
    #stars2,
    #stars3 {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-repeat: repeat;
      background-position: 0 0;
      animation-timing-function: linear;
      animation-iteration-count: infinite;
    }

    #stars {
      background-image: radial-gradient(1px 1px at 20px 30px, #eee, rgba(0, 0, 0, 0)),
        radial-gradient(1px 1px at 40px 70px, #fff, rgba(0, 0, 0, 0)),
        radial-gradient(1px 1px at 90px 40px, #fff, rgba(0, 0, 0, 0)),
        radial-gradient(2px 2px at 130px 80px, #fff, rgba(0, 0, 0, 0)),
        radial-gradient(2px 2px at 160px 120px, #ddd, rgba(0, 0, 0, 0));
      background-size: 200px 200px;
      animation-name: move-stars, twinkle;
      animation-duration: 15s, 5s;
    }

    #stars2 {
      background-image: radial-gradient(1px 1px at 50px 100px, #fff, rgba(0, 0, 0, 0)),
        radial-gradient(1px 1px at 120px 40px, #ddd, rgba(0, 0, 0, 0)),
        radial-gradient(2px 2px at 50px 150px, #fff, rgba(0, 0, 0, 0)),
        radial-gradient(2px 2px at 100px 200px, #ddd, rgba(0, 0, 0, 0));
      background-size: 300px 300px;
      animation-name: move-stars, twinkle;
      animation-duration: 30s, 7s;
    }

    #stars3 {
      background-image: radial-gradient(1px 1px at 80px 50px, #fff, rgba(0, 0, 0, 0)),
        radial-gradient(2px 2px at 150px 100px, #ddd, rgba(0, 0, 0, 0));
      background-size: 400px 400px;
      animation-name: move-stars, twinkle;
      animation-duration: 45s, 10s;
    }

    @keyframes twinkle {
      0% {
        opacity: 0;
      }

      50% {
        opacity: 0.7;
      }

      100% {
        opacity: 0;
      }
    }

    @keyframes move-stars {
      from {
        transform: translateY(0px);
      }

      to {
        transform: translateY(-200px);
      }
    }

    .dark-mode {
      background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
      color: #b0bec5;
    }

    .dark-mode .search-container {
      background: #1a2332;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(100, 181, 246, 0.1);
    }

    .dark-mode .category-section {
      background: #243447;
      border: 1px solid #2d3e52;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .dark-mode .category-section:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
      border-color: #64b5f6;
    }

    .dark-mode .category-title {
      color: #64b5f6;
      border-bottom-color: #64b5f6;
    }

    .dark-mode .radio-group label {
      color: #b0bec5;
    }

    .dark-mode .radio-group label:hover,
    .dark-mode .radio-group label.selected {
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      color: #ffffff;
    }

    .dark-mode #searchInput {
      background: rgba(255, 255, 255, 0.08);
      border: 2px solid #2d3e52;
      color: #b0bec5;
    }

    .dark-mode #searchInput:focus {
      border-color: #64b5f6;
      background: rgba(255, 255, 255, 0.12);
    }

    .dark-mode #searchSource {
      background: #243447;
      color: #b0bec5;
    }

    #googleOperatorFilters .category-title,
    #bingOperatorFilters .category-title,
    #youtubeFilters .category-title,
    #cismefFilters .category-title {
      font-family: 'Roboto', -apple-system, BlinkMSystemFont, 'Segoe UI', Arial, sans-serif;
      font-weight: 700;
    }

    .dark-mode #wikiContent {
      background: #1a2332;
      border-color: #2d3e52;
      color: #b0bec5;
    }

    .dark-mode #wikiContent h4 {
      color: #64b5f6;
    }

    .dark-mode #wikiContent b {
      color: #64b5f6;
      background: #243447;
    }

    .dark-mode #filetypesPopup {
      background: #1a2332;
      border-color: #2d3e52;
      color: #b0bec5;
    }

    .dark-mode #filetypesPopup h3 {
      color: #64b5f6;
      border-bottom-color: #64b5f6;
    }

    .dark-mode #filetypesPopup li.item:hover {
      background: linear-gradient(135deg, #1e3c72, #2a5298);
    }

    .dark-mode #searchForm button[type="submit"] {
      background: linear-gradient(135deg, #4285f4, #34a853);
      box-shadow: 0 4px 12px rgba(66, 133, 244, 0.4);
    }

    .dark-mode #wikiToggleBtn {
      background: linear-gradient(135deg, #cb6d51, #d6845e);
    }

    .dark-mode #filetypesBtn {
      background: linear-gradient(135deg, #4caf50, #45a049);
    }

    .dark-mode #darkModeToggleBtn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .dark-mode button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
    }

    #youtubeFilters {
      display: none;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-bottom: 24px;
      border: 2px solid #667eea;
      box-shadow: 0 4px 24px rgba(102, 126, 234, 0.25);
      padding: 10px;
      border-radius: 12px;
    }

    .dark-mode #youtubeFilters {
      border-color: #64b5f6;
      box-shadow: 0 4px 24px rgba(100, 181, 246, 0.25);
    }

    #googleOperatorFilters {
      display: none;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-bottom: 24px;
      border: 2px solid #4285F4;
      /* Google Blue */
      box-shadow: 0 4px 24px rgba(66, 133, 244, 0.25);
      padding: 10px;
      border-radius: 12px;
    }

    .dark-mode #googleOperatorFilters {
      border-color: #64b5f6;
      box-shadow: 0 4px 24px rgba(100, 181, 246, 0.25);
    }

    #bingOperatorFilters {
      grid-template-columns: repeat(3, 1fr);
      /* Force 3 columns for horizontal layout */
      gap: 15px;
      /* Adjust gap for a tighter fit */
      /* Other styles for bingOperatorFilters are already inherited or defined inline */
    }

    #cismefFilters {
      display: none;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-bottom: 24px;
      border: 2px solid #005689;
      /* CISMeF color */
      box-shadow: 0 4px 24px rgba(0, 86, 137, 0.25);
      padding: 10px;
      border-radius: 12px;
    }

    .dark-mode #cismefFilters {
      border-color: #64b5f6;
      box-shadow: 0 4px 24px rgba(100, 181, 246, 0.25);
    }

    .operators-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .operator-btn {
      background-color: #f1f3f4;
      border: 1px solid #dadce0;
      border-radius: 4px;
      padding: 6px 12px;
      font-size: 13px;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .operator-btn:hover {
      background-color: #e8eaed;
    }

    .dark-mode .operator-btn {
      background-color: #303134;
      border-color: #5f6368;
      color: #e8eaed;
    }

    .dark-mode .operator-btn:hover {
      background-color: #3c4043;
    }

    #googleWikiPopup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 700px;
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      padding: 24px;
      font-size: 14px;
      color: #333;
      display: none;
      z-index: 2000;
    }

    #googleWikiPopup.show {
      display: block;
    }

    .dark-mode #googleWikiPopup {
      background: #1a2332;
      border-color: #2d3e52;
      color: #b0bec5;
    }

    #googleWikiPopup .close-btn {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 28px;
      cursor: pointer;
      color: #999;
      background: none;
      border: none;
      padding: 0;
    }

    #googleWikiPopup .close-btn:hover {
      color: #333;
    }

    .dark-mode #googleWikiPopup .close-btn:hover {
      color: #fff;
    }

    #bingWikiPopup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 700px;
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      padding: 24px;
      font-size: 14px;
      color: #333;
      display: none;
      z-index: 2000;
    }

    #bingWikiPopup.show {
      display: block;
    }

    .dark-mode #bingWikiPopup {
      background: #1a2332;
      border-color: #2d3e52;
      color: #b0bec5;
    }

    #bingWikiPopup .close-btn {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 28px;
      cursor: pointer;
      color: #999;
      background: none;
      border: none;
      padding: 0;
    }

    #bingWikiPopup .close-btn:hover {
      color: #333;
    }

    .dark-mode #bingWikiPopup .close-btn:hover {
      color: #fff;
    }

    #bingWikiPopup h3 {
      margin-top: 0;
      color: #2c3e50;
      border-bottom: 3px solid #667eea;
      padding-bottom: 10px;
    }

    .dark-mode #bingWikiPopup h3 {
      color: #64b5f6;
      border-bottom-color: #64b5f6;
    }

    #keyboardShortcutsPopup {
      position: fixed !important;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 720px;
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.35);
      padding: 24px;
      z-index: 2005;
      /* Higher than overlay (2000) */
      display: none;
    }

    #keyboardShortcutsPopup.show {
      display: block !important;
      /* Force display when .show class is added */
    }

    .dark-mode #keyboardShortcutsPopup {
      background: #1a2332;
      border-color: #2d3e52;
      color: #d0d8e0;
    }

    #keyboardShortcutsPopup .close-btn {
      position: absolute;
      top: 12px;
      right: 16px;
      font-size: 32px;
      cursor: pointer;
      color: #888;
      background: none;
      border: none;
      padding: 0;
      width: auto;
      height: auto;
    }

    #keyboardShortcutsPopup .close-btn:hover {
      color: #333;
      transform: none;
      box-shadow: none;
    }

    .dark-mode #keyboardShortcutsPopup .close-btn:hover {
      color: #eee;
    }

    #googleWikiPopup h3 {
      margin-top: 0;
      color: #2c3e50;
      border-bottom: 3px solid #667eea;
      padding-bottom: 10px;
    }

    .dark-mode #googleWikiPopup h3 {
      color: #64b5f6;
      border-bottom-color: #64b5f6;
    }

    .wiki-table {
      width: 100%;
      border-collapse: collapse;
      margin: 16px 0;
    }

    .wiki-table th,
    .wiki-table td {
      border: 1px solid #ddd;
      padding: 8px 10px;
      text-align: left;
    }

    .wiki-table th {
      background-color: #f2f2f2;
    }

    .wiki-table code {
      background: #f0f0ff;
      padding: 2px 5px;
      border-radius: 4px;
      color: #667eea;
      font-weight: 600;
    }

    .dark-mode .wiki-table,
    .dark-mode .wiki-table th,
    .dark-mode .wiki-table td {
      border-color: #455a64;
    }

    .dark-mode .wiki-table th {
      background-color: #243447;
    }

    .dark-mode .wiki-table code {
      background: #243447;
      color: #82aaff;
    }

    .dark-mode #googleWikiPopup a {
      color: #82aaff;
    }

    .operator-tooltip {
      position: fixed;
      /* Use fixed to position relative to viewport */
      background-color: #333;
      color: #fff;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 13px;
      z-index: 10000;
      pointer-events: none;
      display: none;
      opacity: 0;
      transition: opacity 0.2s ease;
      max-width: 250px;
      text-align: center;
    }

    .dark-mode .operator-tooltip {
      background-color: #e0e0e0;
      color: #1a1a1a;
      border: 1px solid #555;
    }

    .autocomplete-container {
      position: relative;
      flex: 1;
      max-width: 500px;
      min-width: 300px;
    }

    #autocomplete {
      position: fixed;
      /* iOS Floating Island - Glassmorphism */
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(20px) saturate(180%);
      -webkit-backdrop-filter: blur(20px) saturate(180%);

      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;

      /* iOS-style shadow - multiple layers for depth */
      box-shadow:
        0 8px 32px rgba(0, 0, 0, 0.12),
        0 2px 8px rgba(0, 0, 0, 0.08),
        inset 0 1px 0 rgba(255, 255, 255, 0.5);

      max-height: 400px;
      overflow-y: auto;
      z-index: 1000;
      display: none;
      padding: 20px;

      /* Match container width instead of fixed 800px */
      width: calc(100% - 40px);
      max-width: 1160px;
      /* match search-container max-width minus padding */

      /* Smooth appearance animation */
      animation: floatIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      transform-origin: top center;
    }

    @keyframes floatIn {
      from {
        opacity: 0;
        transform: translateY(-10px) scale(0.95);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .dark-mode #autocomplete {
      background: rgba(26, 35, 50, 0.85);
      backdrop-filter: blur(20px) saturate(180%);
      -webkit-backdrop-filter: blur(20px) saturate(180%);
      border: 1px solid rgba(100, 181, 246, 0.2);
      box-shadow:
        0 8px 32px rgba(0, 0, 0, 0.4),
        0 2px 8px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(100, 181, 246, 0.1);
    }

    /* Smooth scrollbar for iOS feel */
    #autocomplete::-webkit-scrollbar {
      width: 8px;
    }

    #autocomplete::-webkit-scrollbar-track {
      background: transparent;
    }

    #autocomplete::-webkit-scrollbar-thumb {
      background: rgba(156, 90, 242, 0.3);
      border-radius: 10px;
      transition: background 0.2s;
    }

    #autocomplete::-webkit-scrollbar-thumb:hover {
      background: rgba(156, 90, 242, 0.5);
    }

    .dark-mode #autocomplete::-webkit-scrollbar-thumb {
      background: rgba(100, 181, 246, 0.3);
    }

    .dark-mode #autocomplete::-webkit-scrollbar-thumb:hover {
      background: rgba(100, 181, 246, 0.5);
    }

    /* 4-COLUMN GRID STRUCTURE */
    .autocomplete-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
    }

    .autocomplete-column {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .autocomplete-column-title {
      font-weight: 900;
      /* Extra bold */
      color: #2c3e50;
      margin-bottom: 8px;
      font-size: 0.95em;
      border-bottom: 2px solid #667eea;
      padding-bottom: 6px;
      font-family: 'Papyrus', cursive, fantasy;
    }

    .dark-mode .autocomplete-column-title {
      color: #64b5f6;
      border-bottom-color: #64b5f6;
    }

    .autocomplete-item {
      padding: 8px 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      border-radius: 6px;
      transition: all 0.2s;
      font-size: 0.9em;
    }

    .autocomplete-item:hover,
    .autocomplete-item.selected {
      background: linear-gradient(135deg, #667eea15, #764ba215);
      transform: translateX(4px);
    }

    .dark-mode .autocomplete-item:hover,
    .dark-mode .autocomplete-item.selected {
      background: #243447;
    }

    .autocomplete-item .favicon-icon {
      flex-shrink: 0;
    }

    .autocomplete-prefix {
      font-family: 'Courier New', monospace;
      font-weight: 700;
      color: #667eea;
      min-width: 60px;
      font-size: 0.85em;
    }

    .dark-mode .autocomplete-prefix {
      color: #64b5f6;
    }

    .autocomplete-name {
      color: #555;
      flex: 1;
      font-size: 0.9em;
    }

    .dark-mode .autocomplete-name {
      color: #b0bec5;
    }

    /* Mobile responsive */
    @media (max-width: 1024px) {
      #autocomplete {
        min-width: 600px;
      }

      .autocomplete-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 600px) {
      #autocomplete {
        min-width: 90vw;
      }

      .autocomplete-grid {
        grid-template-columns: 1fr;
      }
    }

    /* ============================================ */
    /* LANGUAGE TRANSLATION - ENHANCED STYLING */
    /* ============================================ */

    /* Language Icon - Beautiful Circular Button */
    .lang-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, #4285f4 0%, #34a853 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      color: white;
      font-size: 20px;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(66, 133, 244, 0.3);
      user-select: none;
      border: none;
    }

    .lang-icon:hover {
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 4px 16px rgba(66, 133, 244, 0.5);
      background: linear-gradient(135deg, #3367d6 0%, #2d8f46 100%);
    }

    .lang-icon.language-selected {
      background: white;
      color: #4285f4;
      border: 2px solid #4285f4;
      font-weight: 700;
      font-size: 13px;
      font-family: 'Courier New', monospace;
      box-shadow: 0 2px 8px rgba(66, 133, 244, 0.4);
    }

    .lang-icon.language-selected:hover {
      background: #f8f9fa;
      border-color: #3367d6;
      color: #3367d6;
    }

    .dark-mode .lang-icon {
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      box-shadow: 0 2px 8px rgba(30, 60, 114, 0.5);
    }

    .dark-mode .lang-icon:hover {
      background: linear-gradient(135deg, #2a5298, #3a6bb8);
    }

    .dark-mode .lang-icon.language-selected {
      background: #1a2332;
      color: #64b5f6;
      border-color: #64b5f6;
    }

    /* Language Popup - Enhanced */
    #langPopup {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.9);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      padding: 20px;
      overflow: auto;
    }

    #langPopup.show {
      display: flex !important;
    }

    #langPopupContent {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
      padding: 30px;
      max-width: 500px;
      width: 100%;
      max-height: 90vh;
      overflow: auto;
      position: relative;
      animation: popupSlideIn 0.3s ease;
    }

    .dark-mode #langPopupContent {
      background: #1a2332;
      border: 2px solid #2d3e52;
    }

    #langPopupContent .close-btn {
      position: absolute;
      top: 12px;
      right: 12px;
      width: 32px;
      height: 32px;
      border: none;
      background: #dc3545;
      color: white;
      border-radius: 50%;
      cursor: pointer;
      font-size: 20px;
      line-height: 1;
      padding: 0;
      transition: all 0.2s ease;
    }

    #langPopupContent .close-btn:hover {
      background: #c82333;
      transform: rotate(90deg);
      box-shadow: 0 2px 8px rgba(220, 53, 69, 0.4);
    }

    #langPopupContent h2 {
      margin: 0 40px 20px 0;
      color: #333;
      font-size: 22px;
      padding-right: 40px;
    }

    .dark-mode #langPopupContent h2 {
      color: #64b5f6;
    }

    /* Search Bar - Enhanced */
    .lang-search-container {
      margin-bottom: 20px;
    }

    #langSearchInput {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 15px;
      box-sizing: border-box;
      outline: none;
      transition: all 0.2s ease;
    }

    #langSearchInput:focus {
      border-color: #4285f4;
      box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.1);
    }

    .dark-mode #langSearchInput {
      background: #243447;
      border-color: #2d3e52;
      color: #b0bec5;
    }

    .dark-mode #langSearchInput:focus {
      border-color: #64b5f6;
      box-shadow: 0 0 0 3px rgba(100, 181, 246, 0.1);
    }

    #langSuggestions {
      margin-top: 8px;
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      display: none;
      background: white;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .dark-mode #langSuggestions {
      background: #243447;
      border-color: #2d3e52;
    }

    .lang-suggestion {
      padding: 10px 15px;
      cursor: pointer;
      border-bottom: 1px solid #f0f0f0;
      transition: background 0.2s ease;
    }

    .lang-suggestion:hover {
      background: #f0f4ff;
    }

    .lang-suggestion:last-child {
      border-bottom: none;
    }

    .dark-mode .lang-suggestion {
      border-bottom-color: #2d3e52;
    }

    .dark-mode .lang-suggestion:hover {
      background: #2c3e50;
    }

    .lang-suggestion strong {
      color: #333;
      font-weight: 600;
    }

    .lang-suggestion span {
      color: #888;
      font-size: 12px;
    }

    .dark-mode .lang-suggestion strong {
      color: #b0bec5;
    }

    .dark-mode .lang-suggestion span {
      color: #78909c;
    }

    /* Language Buttons - Enhanced */
    .lang-buttons-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-bottom: 15px;
    }

    .lang-btn {
      padding: 14px;
      background: #4285f4;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s ease;
      position: relative;
      box-shadow: 0 2px 4px rgba(66, 133, 244, 0.3);
    }

    .lang-btn:hover {
      background: #3367d6;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(66, 133, 244, 0.4);
    }

    .lang-btn:active {
      transform: translateY(0);
    }

    .lang-btn[data-lang="original"] {
      grid-column: 1 / -1;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      font-size: 15px;
      padding: 16px;
    }

    .lang-btn[data-lang="original"]:hover {
      background: linear-gradient(135deg, #5568d3 0%, #653a8c 100%);
    }

    .dark-mode .lang-btn {
      background: #1e3c72;
      box-shadow: 0 2px 4px rgba(30, 60, 114, 0.5);
    }

    .dark-mode .lang-btn:hover {
      background: #2a5298;
      box-shadow: 0 4px 12px rgba(42, 82, 152, 0.5);
    }

    .dark-mode .lang-btn[data-lang="original"] {
      background: linear-gradient(135deg, #1e3c72, #2a5298);
    }

    /* Hover Tooltip for Language Names */
    .lang-btn::after {
      content: attr(title);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%) translateY(-5px);
      background: rgba(0, 0, 0, 0.9);
      color: white;
      padding: 6px 10px;
      border-radius: 4px;
      font-size: 12px;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease, transform 0.2s ease;
      z-index: 10;
    }

    .lang-btn:hover::after {
      opacity: 1;
      transform: translateX(-50%) translateY(-8px);
    }

    /* Don't show tooltip for Original button */
    .lang-btn[data-lang="original"]::after {
      display: none;
    }

    .dark-mode .lang-btn::after {
      background: rgba(255, 255, 255, 0.95);
      color: #1a2332;
    }

    /* Info Footer - Enhanced */
    .lang-info {
      text-align: center;
      margin: 0;
      color: #666;
      font-size: 12px;
    }

    .dark-mode .lang-info {
      color: #b0bec5;
    }

    .lang-info kbd {
      display: inline-block;
      padding: 2px 6px;
      background: #f4f4f4;
      border: 1px solid #ccc;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
      font-size: 11px;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    .dark-mode .lang-info kbd {
      background: #243447;
      border-color: #455a64;
      color: #b0bec5;
    }

    /* Popup Animation */
    @keyframes popupSlideIn {
      from {
        opacity: 0;
        transform: scale(0.9);
      }

      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      .lang-buttons-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      #langPopupContent {
        padding: 24px;
        max-width: 95%;
      }

      .lang-icon {
        width: 36px;
        height: 36px;
        font-size: 18px;
      }
    }

    @media (max-width: 480px) {
      .lang-buttons-grid {
        grid-template-columns: 1fr;
      }

      .lang-btn[data-lang="original"] {
        grid-column: 1;
      }
    }

    /* Notification Toast */
    .notification {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(33, 33, 33, 0.9);
      color: white;
      padding: 12px 24px;
      border-radius: 50px;
      font-size: 14px;
      z-index: 10000;
      display: flex;
      align-items: center;
      gap: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s ease, transform 0.3s ease;
    }

    .notification.show {
      opacity: 1;
      transform: translateX(-50%) translateY(-10px);
    }

    .notification.success {
      border-left: 4px solid #4CAF50;
    }

    .notification.error {
      border-left: 4px solid #F44336;
    }

    .notification.info {
      border-left: 4px solid #2196F3;
    }

    /* ============================================ */
    /* DYNAMIC ISLAND & MODERN SEARCH BAR */
    /* ============================================ */

    /* ── ISLAND ROW: [site:] [island] [globe/filetypes] ── */
    .island-row {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      width: 100%;
    }

    /* LEFT — site: pill */
    .site-pill {
      display: flex;
      align-items: center;
      gap: 6px;
      background: rgba(0,0,0,0.55);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 20px;
      padding: 7px 14px;
      cursor: pointer;
      flex-shrink: 0;
      color: rgba(255,255,255,0.55);
      font-size: 13px;
      font-weight: 600;
      transition: all 0.2s ease;
      user-select: none;
      white-space: nowrap;
    }

    .site-pill input[type="checkbox"] {
      accent-color: #9c5af2;
      width: 14px;
      height: 14px;
      cursor: pointer;
    }

    .site-pill:hover {
      background: rgba(156,90,242,0.15);
      border-color: rgba(156,90,242,0.4);
      color: #fff;
    }

    .site-pill:has(input:checked) {
      background: rgba(156,90,242,0.2);
      border-color: rgba(156,90,242,0.6);
      color: #c9a6ff;
    }

    /* ── SEARCH ROW: expands on focus ── */
    .yt-search-row {
      display: flex;
      align-items: center;
      flex: 1;
      max-width: 560px;
      min-width: 0;
      gap: 0;
      transition: max-width 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .island-row.row-focused .yt-search-row {
      max-width: 780px;
    }

    /* CENTER — pill input */
    .dynamic-island {
      flex: 1;
      min-width: 0;
      background: #121212;
      border: 1px solid #2e2e2e;
      border-right: none;
      border-radius: 40px 0 0 40px;
      position: relative;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }

    .dynamic-island.focused {
      border-color: #9c5af2;
      box-shadow: inset 0 0 0 1px #9c5af2;
    }

    #searchForm {
      display: flex;
      align-items: center;
      padding: 5px 12px 5px 8px;
      gap: 0;
      height: 46px;
    }

    .engine-indicator {
      width: 34px;
      height: 34px;
      border-radius: 50%;
      background: #2a2a2a;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      margin-right: 10px;
      overflow: hidden;
      transition: background 0.2s ease;
    }

    .dynamic-island.focused .engine-indicator {
      background: #333;
    }

    #search-prefix-favicon {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      object-fit: cover;
      pointer-events: none;
      display: block;
    }

    @keyframes faviconSwap {
      0%   { opacity: 0; transform: scale(0.6); }
      100% { opacity: 1; transform: scale(1); }
    }

    #search-prefix-favicon.swapping {
      animation: faviconSwap 0.18s ease-out forwards;
    }

    #searchInput {
      flex: 1;
      padding: 4px 8px;
      font-size: 16px;
      border: none !important;
      background: transparent !important;
      color: #e8eaed !important;
      outline: none !important;
      box-shadow: none !important;
      caret-color: #9c5af2;
    }

    .yt-search-btn {
      flex-shrink: 0;
      width: 60px;
      height: 46px;
      background: #1e1e1e;
      border: 1px solid #2e2e2e;
      border-left: 1px solid #1e1e1e;
      border-radius: 0 40px 40px 0;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: #909090;
      transition: background 0.15s ease, border-color 0.3s ease, color 0.2s ease;
      padding: 0;
    }

    .yt-search-btn:hover {
      background: #2e2e2e;
      color: #e8eaed;
    }

    .island-right {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      flex-shrink: 0;
    }

    .island-controls {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      width: 100%;
    }

    #searchSource {
      font-size: 12px;
      color: #888;
      font-style: italic;
    }
